<div class="catalog">
  <section class="catalog-header">
    <div class="container">
      <h1 class="fade-in">{{ categoryTitle }}</h1>
      <p class="subtitle text-gray-400">{{ filteredProducts.length }} de {{ products.length }} productos</p>
    </div>
  </section>

  <!-- BARRA DE B√öSQUEDA Y FILTROS -->
  <section class="search-filters">
    <div class="container">
      <!-- Barra de B√∫squeda -->
      <div class="search-bar-wrapper">
        <div class="search-bar">
          <span class="search-icon">üîç</span>
          <input 
            type="text" 
            placeholder="Buscar por nombre, marca o descripci√≥n..."
            [(ngModel)]="searchQuery"
            (input)="onSearchChange()"
            class="search-input"
          />
          <button *ngIf="searchQuery" (click)="searchQuery = ''; onSearchChange()" class="clear-btn">‚úï</button>
        </div>
      </div>

      <!-- Filtros -->
      <div class="filters-grid">
        <!-- Filtro por G√©nero -->
        <div class="filter-group">
          <label class="filter-label">G√©nero</label>
          <select 
            [(ngModel)]="selectedGender"
            (change)="onFilterChange()"
            class="filter-select"
          >
            <option value="">Todos</option>
            <option *ngFor="let gender of genders" [value]="gender">
              {{ genderLabels[gender] }}
            </option>
          </select>
        </div>

        <!-- Filtro por Marca -->
        <div class="filter-group">
          <label class="filter-label">Marca</label>
          <select 
            [(ngModel)]="selectedBrand"
            (change)="onFilterChange()"
            class="filter-select"
          >
            <option value="">Todas las marcas</option>
            <option *ngFor="let brand of brands" [value]="brand">
              {{ brand }}
            </option>
          </select>
        </div>

        <!-- Filtro por Precio M√≠nimo -->
        <div class="filter-group">
          <label class="filter-label">Precio M√≠n: ${{ minPrice }}</label>
          <input 
            type="range" 
            [(ngModel)]="minPrice"
            (input)="onFilterChange()"
            min="0"
            max="200"
            class="filter-range"
          />
        </div>

        <!-- Filtro por Precio M√°ximo -->
        <div class="filter-group">
          <label class="filter-label">Precio M√°x: ${{ maxPrice }}</label>
          <input 
            type="range" 
            [(ngModel)]="maxPrice"
            (input)="onFilterChange()"
            min="0"
            max="200"
            class="filter-range"
          />
        </div>

        <!-- Bot√≥n Limpiar Filtros -->
        <div class="filter-group">
          <button 
            *ngIf="searchQuery || selectedGender || selectedBrand || minPrice > 0 || maxPrice < 200"
            (click)="clearFilters()"
            class="btn-clear-filters"
          >
            üîÑ Limpiar Filtros
          </button>
        </div>
      </div>
    </div>
  </section>

  <section class="catalog-content">
    <div class="container">
      <div class="products-grid" *ngIf="filteredProducts.length > 0">
        <div class="product-card card" *ngFor="let product of filteredProducts" [class.is-out-of-stock]="!product.inStock">
          <div class="product-image">
            <span class="badge-out-of-stock" *ngIf="!product.inStock">Agotado</span>
            <img [src]="product.image" [alt]="product.name" />

          </div>
          <div class="product-info">
            <div class="product-header">
              <h3>{{ product.name }}</h3>
              <span class="gender-badge" [ngClass]="'gender-' + product.gender">
                {{ getGenderLabel(product.gender) }}
              </span>
            </div>
            <p class="brand text-gray-500">{{ product.brand }}</p>
            <p class="size-badge" *ngIf="product.size">{{ product.size }}</p>
            <p class="description text-gray-500" *ngIf="product.description">
              {{ product.description.substring(0, 80) }}...
            </p>
            <div class="notes" *ngIf="product.notes && product.notes.length > 0">
              <span class="note" *ngFor="let note of product.notes.slice(0, 3)">{{ note }}</span>
            </div>
            <div class="product-footer">
              <p class="price">{{ isNumber(product.price) ? '$' + (product.price | number:'1.2-2') : product.price }}</p>
              <a [routerLink]="['/producto', product.id]" class="btn btn-primary">
                Ver Detalles
              </a>
            </div>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="filteredProducts.length === 0">
        <p class="text-gray-400">üòï No se encontraron productos que coincidan con tus filtros.</p>
        <button (click)="clearFilters()" class="btn btn-secondary">Limpiar Filtros e Intentar Nuevamente</button>
      </div>
    </div>
  </section>
</div>
